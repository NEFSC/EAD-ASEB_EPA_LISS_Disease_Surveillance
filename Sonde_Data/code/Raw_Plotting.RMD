---
title: "Sonde_raw_plots"
author: "Samuel Gurr"
date: "2023-10-03"
output: html_document
---

Last updated 6/18/25 by M.Kachmar


## Setup: 

* call your root directory, using opts_knit assigns for the entire script so your paths will alwyas be from this start point!

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE, 
                      message = FALSE, 
                      cache = TRUE)

#knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
knitr::opts_knit$set(root.dir = "C:/Users/kyra.lenderman/documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
#knitr::opts_knit$set(root.dir = "C:/Users/mariah.kachmar/documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")

```

```{r load_libraries, include = TRUE}
# load libraries - notes show the install command needed to install (pre installed)
# Plotting
library(ggplot2)
library(dplyr)
library(gplots)
library(RColorBrewer)
library(ggpubr)
library(stringr)
library(lubridate)
library(readr)
library(reshape2)
library(tidyverse) # read_csv call from readr, included in tidyverse
```



## Load data:

```{r load data}

Master_table <- read.csv("output/Sonde_master.csv",check.names=FALSE) %>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.' )

Master_table$`Date Time` <- lubridate::ymd_hms(Master_table$`Date Time`)

#View(Master_table)

```


```{r}
#pathout <- 'Sonde_Data/output'
```
# Visualize data 


### Raw visual (ready. set. blobs!)

* lets look at an example of raw data 

```{r}
# melt is akin to pivot_longer, but I like that its called melt so I prefer it
# Im melting Im melting
library(reshape2)
library(data.table)
Master_table_LONG <- Master_table %>%  
                      reshape2::melt(id.vars = c("Date Time", "Site"),
                                    measure.vars = c("Actual Conductivity", "Salinity", "Resistivity", 
                                                     "Total Dissolved Solids" ,"RDO Concentration", "RDO Saturation",
                                                     "Oxygen Partial Pressure", "Chlorophyll-a Fluorescence", "pH", "pH mV", 
                                                     "Temperature"))

# View the blobs! 
ggplot(Master_table_LONG,
         aes(x=`Date Time`,
             y=value,
             fill=Site)) +
  geom_point() +
  theme_classic() + 
  facet_wrap(~variable, scales = "free_y")

```

* As suspected this visual is horrible.. we have TONS of data, every 10 seconds to be exact! 

* if we want to view trends, we need to narrow down 

### Hourly means


```{r}
Master_table_LONG_means <- Master_table %>%  
                      dplyr::mutate(`Date Time` = as.factor(substr(`Date Time`,1,13))) %>% # remove minutes and seconds
                      reshape2::melt(id.vars = c("Date Time", "Site"),
                                    measure.vars = c("Actual Conductivity", "Salinity", "Resistivity", 
                                                     "Total Dissolved Solids" ,"RDO Concentration", "RDO Saturation",
                                                     "Oxygen Partial Pressure", "Chlorophyll-a Fluorescence", "pH", "pH mV", 
                                                     "Temperature")) %>% 
                      dplyr::group_by(`Date Time`, Site, variable) %>% 
                      summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), value) %>% 
                      dplyr::mutate(`Date Time` = ymd_h(`Date Time`)) # reformat back to date 

vars <- as.data.frame(
          list(
            as.character(
              unique(
                Master_table_LONG_means$variable)))) %>% 
        dplyr::rename(dat = 1)

write.csv(Master_table_LONG_means, "output/Sonde_hourly_means_master.csv",)

#### CT SITES ONLY ####

CT_means<- Master_table_LONG_means[Master_table_LONG_means$Site == "ASHC" | Master_table_LONG_means$Site =="FENC", ]



write.csv(CT_means, "output/Sonde_hourly_means_CT.csv")




for(i in 1:nrow(vars)) {
  
  # filter table for each variable
  Table_by_var <- Master_table_LONG_means %>% 
                    dplyr::filter(variable %in% vars[i,])
  
  # plot each
  plot <- Table_by_var %>% 
              ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#CC79A7", "#D55E00", "#009E73", "#0072B2")) + 
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site), scales = "free_y") +
              ggtitle(vars[i,]) +
              theme_bw()
  
  # print plots and name them as the var    
  pdf(paste0(path= "/raw_plots",gsub(" ", "_", vars[i,]),".pdf"), height = 12, width = 15)
  print(plot) 
  dev.off()

  } # close the loop


# Temperature pre October 1st 2023 
# why? we have a hefty gap in the FENC data during all october, this is 
# a clean plot for Genevieve's NACE 2024 presentation
#Sonde_Temp_2023 <- Table_by_var %>% 
#    dplyr::filter(variable %in% vars[11,]) %>% 
#    dplyr::filter(``Date Time`` > '2023-06-15 00:00:00' & ``Date Time`` < '2024-05-01 00:00:00') %>% 
#              ggplot(aes(x=``Date Time``, 
#                       y=mean, # the mean values
#                       group=Site)) + # call the new mean
#              geom_line(aes(group = factor(Site), # lines for site
#                                linetype = Site), 
#                            size = 0.2, 
#                            position=position_dodge(.4)) + 
#              # scale_linetype_manual(values=c("solid", "dashed")) +
#              geom_point(aes(shape=Site, 
#                             fill=Site)) + 
#              scale_shape_manual(values=c(21, 22, 24, 25)) + 
#              scale_fill_manual(values=c("#CC79A7", "#D55E00", "#009E73", "#0072B2")) + 
#              geom_errorbar(aes(ymin=(mean)-(se), 
#                                ymax=(mean)+(se)), 
#                            width=0,position=position_dodge(.4)) +
#              facet_grid(rows = vars(Site), scales = "free_y") +
#              ggtitle(vars[11,]) +
#              theme_bw()
# 
#pdf(paste0(path ="output/raw_plots/Temperature_JuneOct_2023.pdf"), height = 12, width = 15)
#print(Sonde_Temp_2023) 
#dev.off()
  
```
#Creating monthly means for juvenile growth stud
```{r}
Master_monthly_means <- Master_table %>%
  # Convert `Date Time` to date-time format and extract the month and year
  dplyr::mutate(``Date Time`` = ymd_hms(``Date Time``),
                year_month = floor_date(``Date Time``, "month")) %>%
  # Melt the data
  melt(id.vars = c("year_month", "Site"),
       measure.vars = c("Actual.Conductivity", "Salinity", "Resistivity", 
                        "Total.Dissolved.Solids", "RDO Concentration", "RDO Saturation",
                        "Oxygen.Partial.Pressure", "Chlorophyll.a.Fluorescence", "pH", "pH.mV", 
                        "Temperature")) %>%
  # Group by year_month, Site, and variable
  dplyr::group_by(year_month, Site, variable) %>%
  # Summarize using across() to get mean, sd, and standard error (se)
  dplyr::summarize(
    mean = mean(value, na.rm = TRUE),
    sd = sd(value, na.rm = TRUE),
    se = sd(value, na.rm = TRUE) / sqrt(n()),
    .groups = "drop"
  )

View(Master_monthly_means)

Sonde_monthly_means_CT<- Master_monthly_means[Master_monthly_means$Site == "ASHC" | Master_monthly_means$Site =="FENC", ]

write.csv(Sonde_monthly_means_CT, "output/Sonde_monthly_means_CT_long.csv")

## We don't want this in long format for all analysis

#we still want means

Sonde_monthly_means_CT_wide <- Sonde_monthly_means_CT %>% pivot_wider(names_from = variable, values_from = c("mean", "sd", "se"))
write.csv(Sonde_monthly_means_CT_wide, "output/Sonde_monthly_means_CT_wide.csv")


```


```{r}
All_Sites_Temperature <- Master_table_LONG_means %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-03-01 00:00:00' & ``Date Time`` < '2025-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', Site == 'FENC' ~ 'Fence Creek', Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=``Date Time``, 
                       y=Temperature, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - 2024") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 20, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

All_Sites_Temperature

```

# Clean CT sites (ASHC and FENC) 
```{r, figs for LISS proposal}

CT_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('FENC', 'ASHC'))
CT_Salinity    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC', 'ASHC'))
CT_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC', 'ASHC'))
CT_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('FENC', 'ASHC'))

# View(CT_Temperature)
# pH 

CT_pH_2023 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - 2023") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

CT_pH_2023

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots","/CT_pH_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_pH_2024, CT_pH_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_pH_2023)
dev.off()

CT_pH_2024 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - 2024") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

CT_pH_2024

CT_pH_2025 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - 2025") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

CT_pH_2025

CT_pH_callout_2023 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-11-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_pH_callout_2023

CT_pH_callout_2024 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_pH_callout_2024

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots","/CT_pH_2024.pdf"), height = 6, width = 11)
#ggarrange(CT_pH_2024, CT_pH_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_pH_2024)
dev.off()
  
CT_pH_callout_2025 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                           width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle 2025") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
#CT_pH_callout_2024

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots","/CT_pH_2025.pdf"), height = 6, width = 11)
#ggarrange(CT_pH_2025, CT_pH_callout_2025, ncol = 2, widths = c(2, 1))
print(CT_pH_2025)
dev.off()


# Salinity 

CT_Salinity_2023 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - 2023") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_Salinity_2023

CT_Salinity_callout_2023 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-11-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_Salinity_callout_2023

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Salinity_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_Salinity_2023, CT_Salinity_callout_2023, ncol = 2, widths = c(2, 1))
print(CT_Salinity_2023)
dev.off()

CT_Salinity_2024 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - 2024") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_Salinity_2024

CT_Salinity_2025 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - 2025") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_Salinity_2025

CT_Salinity_callout_2024 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-11-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
#              theme(legend.position = "none", axis.title.y = element_blank())
#CT_Salinity_callout_2024

  
pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Salinity_2024.pdf"), height = 6, width = 11)
#ggarrange(CT_Salinity_2024, CT_Salinity_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_Salinity_2024)
dev.off()

CT_Salinity_callout_2025 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2025") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
#              theme(legend.position = "none", axis.title.y = element_blank())
#CT_Salinity_callout_2025

  
pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Salinity_2025.pdf"), height = 6, width = 11)
#ggarrange(CT_Salinity_2025, CT_Salinity_callout_2025, ncol = 2, widths = c(2, 1))
print(CT_Salinity_2025)
dev.off()

# Temperature 

CT_Temperature_2023 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_Temperature_2023

CT_Temperature_callout_2023 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
CT_Temperature_callout_2023

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Temperature_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_Temperature_2023, CT_Temperature_callout_2023, ncol = 2, widths = c(2, 1))
print(CT_Temperature_2023)
dev.off()

CT_Temperature_2024 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 16, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_Temperature_2024

CT_Temperature_callout_2024 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+geom_hline(yintercept = 16, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
#CT_Temperature_callout_2024

pdf(paste0(path ="output/raw_plots/LISS_proposal_plots/CT_Temperature_2024.pdf"), height = 6, width = 11)
#ggarrange(CT_Temperature_2024, CT_Temperature_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_Temperature_2024)
dev.off()

CT_Temperature_2025 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2025") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 16, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
CT_Temperature_2025

CT_Temperature_callout_2025 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle 2025") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+geom_hline(yintercept = 16, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
#CT_Temperature_callout_2025

pdf(paste0(path ="output/raw_plots/LISS_proposal_plots/CT_Temperature_2025.pdf"), height = 6, width = 11)
#ggarrange(CT_Temperature_2025, CT_Temperature_callout_2025, ncol = 2, widths = c(2, 1))
print(CT_Temperature_2025)
dev.off()

# DO (Dissolved Oxygen) 

CT_DO_2023 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - 2023") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none")+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

CT_DO_2023
CT_DO_callout_2023 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
CT_DO_callout_2023
pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_DO_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_DO_2023, CT_DO_callout_2023, ncol = 2, widths = c(2, 1))
print(CT_DO_2023)
dev.off()

CT_DO_2024 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - 2024") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none")

CT_DO_2024
CT_DO_callout_2024 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
#CT_DO_callout_2024
pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_DO_2024.pdf"), height = 6, width = 11)
#ggarrange(CT_DO_2024, CT_DO_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_DO_2024)
dev.off()

CT_DO_2025 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - 2025") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none")

CT_DO_2025
CT_DO_callout_2025 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle 2025") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
#CT_DO_callout_2025
pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_DO_2025.pdf"), height = 6, width = 11)
#ggarrange(CT_DO_2025, CT_DO_callout_2025, ncol = 2, widths = c(2, 1))
print(CT_DO_2025)
dev.off()

##########################Grid of June and July 2024 temperature and salinity for HOllings Scholar Juvenille Growth project########################################
CT_means_filtered <- CT_means %>%
  filter(variable %in% c("Temperature", "Salinity", "pH", "RDO Concentration", "Chlorophyll.a.Fluorescence")) %>%dplyr::filter(`Date Time` > '2024-06-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) 

CT_means_filtered<- CT_means_filtered[-c(8868),]


CT.data.plot <-ggplot()+
              geom_line(data=CT_means_filtered%>% filter(Site == "FENC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+ #these next lines help determine the order of how the lines will be presented on the graph. FENC on the bottom
    geom_errorbar(data = CT_means_filtered %>% filter(Site == "FENC"),
                aes(x = Date Time, ymin = mean - se, ymax = mean + se, color = Site), width = 0.2)+
  
  geom_line(data=CT_means_filtered%>% filter(Site == "ASHC"), aes(x=`Date Time`, #ASHC middle
                       y=mean, color = Site))+
  geom_errorbar(data = CT_means_filtered %>% filter(Site == "ASHC"),
                aes(x = `Date Time`, ymin = mean - se, ymax = mean + se, color = Site), width = 0.2) +
  scale_x_datetime(date_breaks = "1 month", date_labels = "%b") +
  
scale_color_manual(values=c(FENC = "darksalmon",ASHC = "cornflowerblue")) +
              #ggtitle("Temperature") +
  theme(axis.text = element_text(size = 18), axis.title = element_text(size = 22), legend.text = element_text(size=18), 
        legend.title = element_text(size=20), title = element_text(size = 24), strip.text = element_text(size = 18), panel.background = element_blank(),axis.line = element_line(color = "black") )+
  facet_wrap(~variable, scales = "free_y", nrow=5) + labs(x = "Date", y = "hourly mean variable")
  #geom_hline(yintercept = 20, color = "red", size = .5)+ #highlighting 20C for dermo infection
  #geom_hline(yintercept = 16, color = "blue", size = .5) #highlighting 16C for spawning


CT.data.plot
  
pdf(paste0(path = "C:/Users/mariah.kachmar/documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Juvenile_growth/outputs/" ,"CT.data.plot.pdf"), height = 12, width = 11) #printing a PDF within the path of the code, with specific dimensions of PDF
print(CT.data.plot) #specify the graph
dev.off()


```

```{r}
#Adding linear regression lines and equations to temperature data
#Going to use this to compare temperature of 2023 and 2024 when more data overlaps
CT_Temperature_2023 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-07-01 00:00:00' & ``Date Time`` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              stat_cor(label.y = 32)+
              geom_smooth(method = "lm")+
              stat_regline_equation(label.y = 35)+
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")
CT_Temperature_2023

#pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Temperature_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_Temperature_2023, CT_Temperature_callout_2023, ncol = 2, widths = c(2, 1))
#print(CT_Temperature_2023)
#dev.off()

```

```{r}
CT_Temperature_2023 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-07-01 00:00:00' & ``Date Time`` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              stat_cor(label.y = 32)+
              geom_smooth(method = "lm")+
              stat_regline_equation(label.y = 35)+
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")
CT_Temperature_2023
```



```{r}
#Separating temperature data by year at ASHC
CT_Temperature_test <- CT_Temperature %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_Temperature_test$`Date Time` <- sub('.....', '', CT_Temperature$`Date Time`) 
CT_Temperature_ASHC <- CT_Temperature_test %>% filter(!Site=="FENC")
CT_Temperature_ASHC$`Date Time` <- as.Date(CT_Temperature_ASHC$`Date Time`, "%m-%d")
CT_Temperature_ASHC$Year <- as.factor(CT_Temperature_ASHC$Year)

CT_Temperature_ASHC_yearly <- CT_Temperature_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - ASHC") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic()

CT_Temperature_ASHC_yearly


#Graph for all temperature data at ASHC (continuous)
CT_Temperature_ASHC_all <- CT_Temperature %>% na.omit() %>% filter(Site == "ASHC") %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              ggtitle("Temperature - ASHC") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic()
CT_Temperature_ASHC_all
```
```{r}
#Separating salinity data by year at ASHC
CT_Salinity_test <- CT_Salinity %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_Salinity_test$`Date Time` <- sub('.....', '', CT_Salinity_test$`Date Time`) 
CT_Salinity_ASHC <- CT_Salinity_test %>% filter(!Site=="FENC")
CT_Salinity_ASHC$``Date Time`` <- as.Date(CT_Salinity_ASHC$`Date Time`, "%m-%d")
CT_Salinity_ASHC$Year <- as.factor(CT_Salinity_ASHC$Year)

CT_Salinity_ASHC_yearly <- CT_Salinity_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 15, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - ASHC") +
              labs(x = "Time", y = "Salinity (ppt)") +
              theme_classic()

CT_Salinity_ASHC_yearly


#Graph for all salinity data at ASHC (continuous)
CT_Salinity_ASHC_all <- CT_Salinity %>% na.omit() %>% filter(Site=="ASHC")%>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) +  
              geom_hline(yintercept = 15, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              ggtitle("Salinity - ASHC") +
              labs(x = "Time", y = "Salinity (ppt)") +
              theme_classic()
CT_Salinity_ASHC_all
```
```{r}
#Separating pH data by year at ASHC
CT_pH_test <- CT_pH %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_pH_test$`Date Time` <- sub('.....', '', CT_pH_test$`Date Time`) 
CT_pH_ASHC <- CT_pH_test %>% filter(!Site=="FENC")
CT_pH_ASHC$`Date Time` <- as.Date(CT_pH_ASHC$`Date Time`, "%m-%d")
CT_pH_ASHC$Year <- as.factor(CT_pH_ASHC$Year)

CT_pH_ASHC_yearly <- CT_pH_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - ASHC") +
              labs(x = "Time", y = "pH") +
              theme_classic()

CT_pH_ASHC_yearly

#Graph for all pH data at ASHC (continuous)
CT_pH_ASHC_all <- CT_pH %>% na.omit() %>% filter(Site=="ASHC")%>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) +  
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              ggtitle("pH - ASHC") +
              labs(x = "Time", y = "pH") +
              theme_classic()
CT_pH_ASHC_all
```


```{r}
#Separating DO data by year at ASHC
CT_DO_test <- CT_DO %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_DO_test$`Date Time` <- sub('.....', '', CT_DO_test$`Date Time`) 
CT_DO_ASHC <- CT_DO_test %>% filter(!Site=="FENC")
CT_DO_ASHC$`Date Time` <- as.Date(CT_DO_ASHC$`Date Time`, "%m-%d")
CT_DO_ASHC$Year <- as.factor(CT_DO_ASHC$Year)

CT_DO_ASHC_yearly <- CT_DO_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO - ASHC") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic()

CT_DO_ASHC_yearly

#Graph for all DO data at ASHC (continuous)
CT_DO_ASHC_all <- CT_DO %>% na.omit() %>% filter(Site=="ASHC")%>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) +  
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              ggtitle("DO - ASHC") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic()
CT_DO_ASHC_all
```

# Clean ASHC for the LISS stakeholder reports (CT)
```{r, figs for LISS stakeholder reports}

ASHC_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('ASHC'))
ASHC_Salinity    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('ASHC'))
ASHC_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('ASHC'))
ASHC_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('ASHC'))
ASHC_CHLA        <- Master_table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('ASHC'))


# pH 

ASHC_pH_2023 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>%  # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2023 ") +
              labs(x = "Time ", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_pH_2023

ASHC_pH_callout_2023 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
ASHC_pH_2023
ASHC_pH_callout_2023

#pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_pH_2023.pdf"), height = 7, width = 14)
#print(ASHC_pH_2023)
#ggarrange(ASHC_pH_all,ASHC_pH_callout, ncol = 2, widths = c(2, 1))
#dev.off()
  
ASHC_pH_2024 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>%  # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2024") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_pH_callout_2024 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2025-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
ASHC_pH_2024
#ASHC_pH_callout_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_pH_2024.pdf"), height = 7, width = 14)
print(ASHC_pH_2024)
#ggarrange(ASHC_pH_all,ASHC_pH_callout, ncol = 2, widths = c(2, 1))
dev.off()

ASHC_pH_2025 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>%  # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2025") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
ASHC_pH_2025

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_pH_2025.pdf"), height = 7, width = 14)
print(ASHC_pH_2025)
dev.off()

# Salinity 

ASHC_Salinity_2023 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2023") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 10, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_Salinity_2023

ASHC_Salinity_2023 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_Salinity_2023

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Salinity_2023.pdf"), height = 7, width = 14)
print(ASHC_Salinity_2023)
#ggarrange(ASHC_Salinity_all,ASHC_Salinity_callout, ncol = 2, widths = c(2, 1))
dev.off()

ASHC_Salinity_2024 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2024") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 10, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_Salinity_2024

ASHC_Salinity_callout_2024 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2025-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+scale_x_datetime(breaks="1 month", date_labels = "%B")

#ASHC_Salinity_callout_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Salinity_2024.pdf"), height = 7, width = 14)
print(ASHC_Salinity_2024)
#ggarrange(ASHC_Salinity_all,ASHC_Salinity_callout, ncol = 2, widths = c(2, 1))
dev.off()

ASHC_Salinity_2025 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2025") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 10, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_Salinity_2025

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Salinity_2025.pdf"), height = 7, width = 14)
print(ASHC_Salinity_2025)
dev.off()

# Temperature 

ASHC_Temperature_2023 <-ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+scale_x_datetime(breaks="1 month", date_labels = "%B")
ASHC_Temperature_2023

ASHC_Temperature_callout_2023 <- ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+scale_x_datetime(breaks="1 month", date_labels = "%B")
ASHC_Temperature_callout_2023

#pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Temperature_2023.pdf"), height = 7, width = 14)
#print(ASHC_Temperature_2023)
#ggarrange(ASHC_Temperature_all, ASHC_Temperature_callout, ncol = 2, widths = c(2, 1))
#dev.off()

ASHC_Temperature_2024 <-ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 20, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
ASHC_Temperature_2024

ASHC_Temperature_callout_2024 <- ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+scale_x_datetime(breaks="1 month", date_labels = "%B")
#ASHC_Temperature_callout_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Temperature_2024.pdf"), height = 7, width = 14)
print(ASHC_Temperature_2024)
#ggarrange(ASHC_Temperature_all, ASHC_Temperature_callout, ncol = 2, widths = c(2, 1))
dev.off()

ASHC_Temperature_2025 <-ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2025") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 20, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
ASHC_Temperature_2025

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Temperature_2025.pdf"), height = 7, width = 14)
print(ASHC_Temperature_2025)
dev.off()

# DO 

ASHC_DO_2023 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_DO_callout_2023 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

#pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_DO_2023.pdf"), height = 7, width = 14)
#print(ASHC_DO_2023)
#ggarrange(ASHC_DO_all, ASHC_DO_callout, ncol = 2, widths = c(2, 1))
#dev.off()

ASHC_DO_2024 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 12:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_DO_callout_2024 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())+scale_x_datetime(breaks="1 month", date_labels = "%B")

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_DO_2024.pdf"), height = 7, width = 14)
print(ASHC_DO_2024)
#ggarrange(ASHC_DO_all, ASHC_DO_callout, ncol = 2, widths = c(2, 1))
dev.off()

ASHC_DO_2025 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 12:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2025") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+geom_hline(yintercept = 5, color = "red", linetype = "solid", size = 1)+scale_x_datetime(breaks="1 month", date_labels = "%B")
ASHC_DO_2025

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_DO_2025.pdf"), height = 7, width = 14)
print(ASHC_DO_2025)
dev.off()

#Chlorophyll-a

ASHC_CHLA_2023 <- ASHC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2023 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+scale_x_datetime(breaks="1 month", date_labels = "%B")

ASHC_CHLA_2023

#pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_CHLA_2023.pdf"), height = 7, width = 14)
#print(ASHC_CHLA_2023)

ASHC_CHLA_2024 <- ASHC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              #scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2024 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+scale_x_datetime(breaks="1 month", date_labels = "%B")+ylim(0,20)

ASHC_CHLA_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_CHLA_2024.pdf"), height = 7, width = 14)
print(ASHC_CHLA_2024)


ASHC_CHLA_2025 <- ASHC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2022-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              #scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2025") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+scale_x_datetime(breaks="1 month", date_labels = "%B")+ylim(0,20)

ASHC_CHLA_2025

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_CHLA_2025.pdf"), height = 7, width = 14)
print(ASHC_CHLA_2025)
```


```{r}

## DAILY AVERAGES OF DO - ASHC###

ASHC_DO$`Date Time` <- as.character(ASHC_DO$`Date Time`)
date_time <- strsplit(ASHC_DO$`Date Time`, " ")  # Split at the space
print(ASHC_DO)

# Create separate columns for date and time
ASHC_DO$date <- sapply(date_time, "[[", 1)  # Extract date
#ASHC_DO$time <- sapply(date_time, "[[", 2)
print(ASHC_DO)


ASHC_DO_avg <- ASHC_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
ASHC_DO_avg

 

class(ASHC_DO_avg$Date)
ASHC_DO_avg$date <- as.Date(ASHC_DO_avg$date)

ASHC_DAILY_DO_2023 <- ASHC_DO_avg %>% 
   dplyr::filter(date() > '2023-06-01 00:00:00' & date < '2023-11-30 00:00:00' ) %>%
    ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d") +
  scale_y_continuous(limits= c(2,10), breaks = seq(2,10, by= 1))+geom_hline(yintercept = 5, color = "red", linetype = "solid", size = 1)+geom_hline(yintercept = 3, color = "blue", linetype = "solid", size = 1)



ASHC_DAILY_DO_2023

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_daily_DO_2023.pdf"), height = 7, width = 14)
print(ASHC_DAILY_DO_2023)


ASHC_DAILY_DO_2024 <- ASHC_DO_avg %>% 
   dplyr::filter(date > '2024-03-01 00:00:00' & date < '2025-11-30 00:00:00' ) %>%
    ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d") +
  scale_y_continuous(limits= c(2,20), breaks = seq(2,10, by= 1))+geom_hline(yintercept = 5, color = "red", linetype = "solid", size = 1)+geom_hline(yintercept = 3, color = "blue", linetype = "solid", size = 1)


ASHC_DAILY_DO_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_daily_DO_2024.pdf"), height = 7, width = 14)
print(ASHC_DAILY_DO_2024)

# Monthly mean temperatures ASHC
ASHC_Temperature$`Date Time` <- as.character(ASHC_Temperature$`Date Time`)
date_time <- strsplit(ASHC_Temperature$`Date Time`, " ")  # Split at the space
print(ASHC_Temperature)

# Create separate columns for date and time
ASHC_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
#ASHC_Temperature$time <- sapply(date_time, "[[", 2)
print(ASHC_Temperature)

ASHC_Temperature$Month <- month(ASHC_Temperature$date)
head(ASHC_Temperature)

ASHC_Temperature$Year <- year(ASHC_Temperature$date)
head(ASHC_Temperature)

ASHC_Monthly_Temperature <- ASHC_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
ASHC_Monthly_Temperature

```

#Graphed sonde data for FENC seperated by year
```{r}
#Separating temperature data by year at FENC
CT_temp_test <- CT_Temperature %>% dplyr::mutate(``Date Time``= as.Date(``Date Time``), Year = year(``Date Time``))
CT_temp_test$``Date Time`` <- sub('.....', '', CT_temp_test$``Date Time``) 
CT_temp_FENC <- CT_temp_test %>% filter(!Site=="ASHC")
CT_temp_FENC$``Date Time`` <- as.Date(CT_temp_FENC$``Date Time``, "%m-%d")
CT_temp_FENC$Year <- as.factor(CT_temp_FENC$Year)

CT_temp_FENC_yearly <- CT_temp_FENC %>% na.omit() %>%
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              geom_hline(yintercept = 30, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - FENC") +
              labs(x = "Time", y = "Temperature (C)") +
              theme_classic()

CT_temp_FENC_yearly

#Graph for all temperature data at FENC (continuous)
CT_Temperature_FENC_all <- CT_Temperature %>% na.omit() %>% filter(Site == "FENC") %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              ggtitle("Temperature - FENC") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic()
CT_Temperature_FENC_all
```
```{r}
#Separating salinity data by year at FENC
CT_salinity_test <- CT_Salinity %>% dplyr::mutate(``Date Time``= as.Date(``Date Time``), Year = year(``Date Time``))
CT_salinity_test$``Date Time`` <- sub('.....', '', CT_salinity_test$``Date Time``) 
CT_salinity_FENC <- CT_salinity_test %>% filter(!Site=="ASHC")
CT_salinity_FENC$``Date Time`` <- as.Date(CT_salinity_FENC$``Date Time``, "%m-%d")
CT_salinity_FENC$Year <- as.factor(CT_salinity_FENC$Year)

CT_salinity_FENC_yearly <- CT_salinity_FENC %>% na.omit() %>%
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 15, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - FENC") +
              labs(x = "Time", y = "Salinity (ppt)") +
              theme_classic()

CT_salinity_FENC_yearly

#Graph for all salinity data at FENC (continuous)
CT_salinity_FENC_all <- CT_Salinity %>% na.omit() %>% filter(Site == "FENC") %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              ggtitle("Salinity - FENC") +
              labs(x = "Time", y = "Salinity (ppt)") +
              theme_classic()
CT_salinity_FENC_all
```
```{r}
#Separating pH data by year at FENC

#CT_pH_test <- CT_pH %>% dplyr::mutate(``Date Time``= as.Date(``Date Time``), Year = year(``Date Time``))
#CT_pH_test$``Date Time`` <- sub('.....', '', CT_pH_test$``Date Time``) 
CT_pH_test <- CT_pH %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_pH_test$``Date Time`` <- sub('.....', '', CT_pH_test$`Date Time`)
CT_ph_FENC <- CT_pH_test %>% filter(!Site=="ASHC")
CT_ph_FENC$`Date Time` <- as.Date(CT_ph_FENC$`Date Time`, "%m-%d")
CT_ph_FENC$Year <- as.factor(CT_ph_FENC$Year)

CT_pH_FENC_yearly <- CT_ph_FENC %>% na.omit() %>%
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 7.5, color = "red", size = 1)+
              geom_hline(yintercept = 7, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - FENC") +
              labs(x = "Time", y = "pH") +
              theme_classic()

CT_pH_FENC_yearly

#Graph for all pH data at FENC (continuous)
CT_pH_FENC_all <- CT_pH %>% na.omit() %>% filter(Site == "FENC") %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              geom_hline(yintercept = 7.5, color = "red", size = 1)+
              geom_hline(yintercept = 7, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              ggtitle("pH - FENC") +
              labs(x = "Time", y = "pH") +
              theme_classic()
CT_pH_FENC_all
```
```{r}
#Separating DO data by year at FENC

CT_DO_test <- CT_DO %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_DO_test$`Date Time` <- sub('.....', '', CT_DO_test$`Date Time`) 
CT_DO_FENC <- CT_DO_test %>% filter(!Site=="ASHC")
CT_DO_FENC$`Date Time` <- as.Date(CT_DO_FENC$`Date Time`, "%m-%d")
CT_DO_FENC$Year <- as.factor(CT_DO_FENC$Year)

CT_DO_FENC_yearly <- CT_DO_FENC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 2, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO - FENC") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic()

CT_DO_FENC_yearly

#Graph for all pH data at FENC (continuous)
CT_DO_FENC_all <- CT_DO %>% na.omit() %>% filter(Site == "FENC") %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              geom_hline(yintercept = 2, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              ggtitle("DO - FENC") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic()
CT_DO_FENC_all
```

# Clean FENC for the LISS stakeholder reports (CT)
```{r, figs for LISS stakeholder reports}

FENC_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('FENC'))
FENC_Salinity   <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC'))
FENC_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC'))
FENC_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('FENC'))
FENC_CHLA        <- Master_table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('FENC'))

# pH 

FENC_pH_2023 <- FENC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Ash Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2023") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


FENC_pH_2023


#pdf(paste0(path = "output/raw_plots/Report_plots/FENC_pH_2023.pdf"), height = 7, width = 14)
#print(FENC_pH_2023)
#dev.off()
  
FENC_pH_2024 <- FENC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Ash Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2024") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


FENC_pH_2024


pdf(paste0(path = "output/raw_plots/Report_plots/FENC_pH_2024.pdf"), height = 7, width = 14)
print(FENC_pH_2024)
dev.off()

FENC_pH_2025 <- FENC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Ash Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2025") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


FENC_pH_2025


pdf(paste0(path = "output/raw_plots/Report_plots/FENC_pH_2025.pdf"), height = 7, width = 14)
print(FENC_pH_2025)
dev.off()

# Salinity 

FENC_Salinity_2023 <- FENC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2023") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

FENC_Salinity_2023

#pdf(paste0(path = "output/raw_plots/Report_plots/FENC_Salinity_2023.pdf"), height = 7, width = 14)
#print(FENC_Salinity_2023)
#dev.off()

FENC_Salinity_2024 <- FENC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2024") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

FENC_Salinity_2024

pdf(paste0(path = "output/raw_plots/Report_plots/FENC_Salinity_2024.pdf"), height = 7, width = 14)
print(FENC_Salinity_2024)
dev.off()


FENC_Salinity_2025 <- FENC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2025") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

FENC_Salinity_2025

pdf(paste0(path = "output/raw_plots/Report_plots/FENC_Salinity_2025.pdf"), height = 7, width = 14)
print(FENC_Salinity_2025)
dev.off()

# Temperature 

FENC_Temperature_2023 <-FENC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
FENC_Temperature_2023

#pdf(paste0(path="output/raw_plots/Report_plots/FENC_Temperature_2023.pdf"), height = 7, width = 14)
#print(FENC_Temperature_2023)
#dev.off()

FENC_Temperature_2024 <-FENC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
FENC_Temperature_2024

pdf(paste0(path="output/raw_plots/Report_plots/FENC_Temperature_2024.pdf"), height = 7, width = 14)
print(FENC_Temperature_2024)
dev.off()

FENC_Temperature_2025 <-FENC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2025") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
FENC_Temperature_2025

pdf(paste0(path="output/raw_plots/Report_plots/FENC_Temperature_2025.pdf"), height = 7, width = 14)
print(FENC_Temperature_2025)
dev.off()


# DO 

FENC_DO_2023 <- FENC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

#pdf(paste0(path = "output/raw_plots/Report_plots/FENC_DO_2023.pdf"), height = 7, width = 14)
#print(FENC_DO_2023)
#dev.off()

FENC_DO_2024 <- FENC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path = "output/raw_plots/Report_plots/FENC_DO_2024.pdf"), height = 7, width = 14)
print(FENC_DO_2024)
dev.off()

FENC_DO_2025 <- FENC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2025") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path = "output/raw_plots/Report_plots/FENC_DO_2025.pdf"), height = 7, width = 14)
print(FENC_DO_2025)
dev.off()


#Chlorophyll-a

FENC_CHLA_2023 <- FENC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2023") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

FENC_CHLA_2023

pdf(paste0(path="output/raw_plots/Report_plots/FENC_CHLA_2023.pdf"), height = 7, width = 14)
print(FENC_CHLA_2023)


FENC_CHLA_2024 <- FENC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2024") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

FENC_CHLA_2024

pdf(paste0(path="output/raw_plots/Report_plots/FENC_CHLA_2024.pdf"), height = 7, width = 14)
print(FENC_CHLA_2024)

FENC_CHLA_2025 <- FENC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2025") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

FENC_CHLA_2025

pdf(paste0(path="output/raw_plots/Report_plots/FENC_CHLA_2025.pdf"), height = 7, width = 14)
print(FENC_CHLA_2025)

```

```{r}

## DAILY AVERAGES OF DO - FENC ###

FENC_DO$`Date Time` <- as.character(FENC_DO$`Date Time`)
date_time <- strsplit(FENC_DO$`Date Time`, " ")  # Split at the space
print(FENC_DO)

# Create separate columns for date and time
FENC_DO$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_DO)


FENC_DO_avg <- FENC_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
FENC_DO_avg


class(FENC_DO_avg$Date)
FENC_DO_avg$date <- as.Date(FENC_DO_avg$date)

FENC_DO_avg

FENC_DAILY_DO_2023 <- FENC_DO_avg %>% dplyr::filter(`date` > '2023-06-01 00:00:00' & `date` < '2023-10-15 00:00:00' ) %>% 
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")  +  scale_y_continuous(limits = c(0,10), breaks = seq(0,10, by = 1))


FENC_DAILY_DO_2023

pdf(paste0(path="output/raw_plots/Report_plots/FENC_daily_DO_2023.pdf"), height = 7, width = 14)
print(FENC_DAILY_DO_2023)

FENC_DAILY_DO_2024 <- FENC_DO_avg %>% dplyr::filter(`date` > '2024-03-01 00:00:00' & `date` < '2025-11-30 00:00:00' ) %>% 
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")  +  scale_y_continuous(limits = c(0,10), breaks = seq(0,10, by = 1))


FENC_DAILY_DO_2024

pdf(paste0(path="output/raw_plots/Report_plots/FENC_daily_DO_2024.pdf"), height = 7, width = 14)
print(FENC_DAILY_DO_2024)

# Monthly mean temperatures ASHC
FENC_Temperature$`Date Time` <- as.character(FENC_Temperature$`Date Time`)
date_time <- strsplit(FENC_Temperature$`Date Time`, " ")  # Split at the space
print(FENC_Temperature)

# Create separate columns for date and time
FENC_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_Temperature)

FENC_Temperature$Month <- month(FENC_Temperature$date)
head(FENC_Temperature)

FENC_Temperature$Year <- year(FENC_Temperature$date)
head(FENC_Temperature)

FENC_Monthly_Temperature <-FENC_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
FENC_Monthly_Temperature

#Salinity average
FENC_Salinity$`Date Time` <- as.character(FENC_Salinity$`Date Time`)
date_time <- strsplit(FENC_Salinity$`Date Time`, " ")  # Split at the space
print(FENC_Salinity)

# Create separate columns for date and time
FENC_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_Salinity)

FENC_Salinity$Month <- month(FENC_Salinity$date)
head(FENC_Salinity)

FENC_Salinity$Year <- year(FENC_Salinity$date)
head(FENC_Salinity)

FENC_Monthly_Salinity <- FENC_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
FENC_Monthly_Salinity

```


# Clean GOLD for the LISS stakeholder reports (NEW YORK)
#I want to create code to remove outliers for these graphs. Outliers are obvious temperature drops when the sonde is removed from the water. 
```{r, figs for LISS stakeholder reports}

GOLD_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('GOLD')) 
GOLD_Salinity    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('GOLD'))
GOLD_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('GOLD'))
GOLD_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO.Concentration' & Site %in% c('GOLD'))
GOLD_CHLA        <- Master_table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll.a.Fluorescence' & Site %in% c('GOLD'))




# pH 

GOLD_pH_2023 <- GOLD_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2023") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


GOLD_pH_2023


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_pH_2023.pdf"), height = 7, width = 14)
print(GOLD_pH_2023)
dev.off()
  
GOLD_pH_2024 <- GOLD_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2024") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+  
  geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1) +ylim(6,9) +scale_x_datetime(breaks="1 month", date_labels = "%B")



GOLD_pH_2024


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_pH_2024.pdf"), height = 7, width = 14)
print(GOLD_pH_2024)
dev.off()

GOLD_pH_2025 <- GOLD_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             # facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2025") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+  
  geom_hline(yintercept = 7.5, color = "red", linetype = "solid", size = 1) +ylim(6,9) +scale_x_datetime(breaks="1 month", date_labels = "%B")



GOLD_pH_2025


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_pH_2025.pdf"), height = 7, width = 14)
print(GOLD_pH_2025)
dev.off()

# Salinity 

GOLD_Salinity_2023 <- GOLD_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2023") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

GOLD_Salinity_2023

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Salinity_2023.pdf"), height = 7, width = 14)
print(GOLD_Salinity_2023)
dev.off()

GOLD_Salinity_2024 <- GOLD_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2024") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))+  
  geom_hline(yintercept = 12, color = "red", linetype = "solid", size = 1)+ylim(20,30)+scale_x_datetime(breaks="1 month", date_labels = "%B")

GOLD_Salinity_2024

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Salinity_2024.pdf"), height = 7, width = 14)
print(GOLD_Salinity_2024)
dev.off()

GOLD_Salinity_2025 <- GOLD_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:01:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2025") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))+  
  geom_hline(yintercept = 12, color = "red", linetype = "solid", size = 1)+ylim(20,30)+scale_x_datetime(breaks="1 month", date_labels = "%B")

GOLD_Salinity_2025

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Salinity_2025.pdf"), height = 7, width = 14)
print(GOLD_Salinity_2025)
dev.off()
# Temperature 

GOLD_Temperature_2023 <-GOLD_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
GOLD_Temperature_2023


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Temperature_2023.pdf"), height = 7, width = 14)
print(GOLD_Temperature_2023)
dev.off()

GOLD_Temperature_2024 <-GOLD_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+  
  geom_hline(yintercept = 20, color = "red", linetype = "solid", size = 1) +scale_x_datetime(breaks="1 month", date_labels = "%B")
GOLD_Temperature_2024


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Temperature_2024.pdf"), height = 7, width = 14)
print(GOLD_Temperature_2024)
dev.off()

GOLD_Temperature_2025 <-GOLD_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-01-01 00:00:00' & `Date Time` < '2025-12-31 23:59:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2025") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+  
  geom_hline(yintercept = 20, color = "red", linetype = "solid", size = 1) +scale_x_datetime(breaks="1 month", date_labels = "%B")
GOLD_Temperature_2025


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Temperature_2025.pdf"), height = 7, width = 14)
print(GOLD_Temperature_2025)
dev.off()

# DO 

GOLD_DO_2023 <- GOLD_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_DO_2023.pdf"), height = 7, width = 14)
print(GOLD_DO_2023)
dev.off()

GOLD_DO_2024 <- GOLD_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             # facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +theme(legend.position = "none", axis.text= element_text(size= 15))+  geom_hline(yintercept = 5, color = "red", linetype= "solid", size = 1) +
  scale_x_datetime(breaks="1 month", date_labels = "%B")

GOLD_DO_2024
pdf(paste0(path="output/raw_plots/Report_plots/GOLD_DO_2024.pdf"), height = 7, width = 14)
print(GOLD_DO_2024)
dev.off()

GOLD_DO_2025 <- GOLD_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-04-01 00:00:00' & `Date Time` < '2025-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2025") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +theme(legend.position = "none", axis.text= element_text(size= 15))+  geom_hline(yintercept = 5, color = "red", linetype= "solid", size = 1) +
  scale_x_datetime(breaks="1 month", date_labels = "%B")

GOLD_DO_2025
pdf(paste0(path="output/raw_plots/Report_plots/GOLD_DO_2025.pdf"), height = 7, width = 14)
print(GOLD_DO_2025)
dev.off()
#Chlorophyll-a

GOLD_CHLA_2023 <- GOLD_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2023 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

GOLD_CHLA_2023

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_CHLA_2023.pdf"), height = 7, width = 14)
print(GOLD_CHLA_2023)

GOLD_CHLA_2024 <- GOLD_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
             # facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2024 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+scale_x_datetime(breaks="1 month", date_labels = "%B")

GOLD_CHLA_2024

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_CHLA_2024.pdf"), height = 7, width = 14)
print(GOLD_CHLA_2024)

GOLD_CHLA_2025 <- GOLD_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2025-04-01 00:00:00' & `Date Time` < '2025-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2025 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+scale_x_datetime(breaks="1 month", date_labels = "%B")

GOLD_CHLA_2025

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_CHLA_2025.pdf"), height = 7, width = 14)
print(GOLD_CHLA_2025)
```
#Graphed sonde data for GOLD seperated by year
```{r}
#Separating temperature data by year at GOLD
NY_temp_test <- NY_Temperature %>% dplyr::mutate(``Date Time``= as.Date(``Date Time``), Year = year(``Date Time``))
NY_temp_test$``Date Time`` <- sub('.....', '', NY_temp_test$``Date Time``) 
NY_temp_GOLD <- NY_temp_test %>% filter(!Site=="ASHC")
NY_temp_GOLD$``Date Time`` <- as.Date(NY_temp_GOLD$``Date Time``, "%m-%d")
NY_temp_GOLD$Year <- as.faNYor(NY_temp_GOLD$Year)

NY_temp_GOLD_yearly <- NY_temp_GOLD %>% na.omit() %>%
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = faNYor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              geom_hline(yintercept = 30, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - GOLD") +
              labs(x = "Time", y = "Temperature (C)") +
              theme_classic()

NY_temp_GOLD_yearly
```
```{r}
#Separating salinity data by year at GOLD
NY_salinity_test <- NY_Salinity %>% dplyr::mutate(``Date Time``= as.Date(``Date Time``), Year = year(``Date Time``))
NY_salinity_test$``Date Time`` <- sub('.....', '', NY_salinity_test$``Date Time``) 
NY_salinity_GOLD <- NY_salinity_test %>% filter(!Site=="ASHC")
NY_salinity_GOLD$``Date Time`` <- as.Date(NY_salinity_GOLD$``Date Time``, "%m-%d")
NY_salinity_GOLD$Year <- as.faNYor(NY_salinity_GOLD$Year)

NY_salinity_GOLD_yearly <- NY_salinity_GOLD %>% na.omit() %>%
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = faNYor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 15, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - GOLD") +
              labs(x = "Time", y = "Salinity (ppt)") +
              theme_classic()

NY_salinity_GOLD_yearly
```
```{r}
#Separating pH data by year at GOLD

#NY_pH_test <- NY_pH %>% dplyr::mutate(``Date Time``= as.Date(``Date Time``), Year = year(``Date Time``))
#NY_pH_test$``Date Time`` <- sub('.....', '', NY_pH_test$``Date Time``) 
NY_ph_GOLD <- NY_pH_test %>% filter(!Site=="ASHC")
NY_ph_GOLD$``Date Time`` <- as.Date(NY_ph_GOLD$``Date Time``, "%m-%d")
NY_ph_GOLD$Year <- as.faNYor(NY_ph_GOLD$Year)

NY_pH_GOLD_yearly <- NY_ph_GOLD %>% na.omit() %>%
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = faNYor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 7.5, color = "red", size = 1)+
              geom_hline(yintercept = 6.75, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - GOLD") +
              labs(x = "Time", y = "pH") +
              theme_classic()

NY_pH_GOLD_yearly
```
```{r}
#Separating DO data by year at GOLD

NY_DO_test <- NY_DO %>% dplyr::mutate(``Date Time``= as.Date(``Date Time``), Year = year(``Date Time``))
NY_DO_test$``Date Time`` <- sub('.....', '', NY_DO_test$``Date Time``) 
NY_DO_GOLD <- NY_DO_test %>% filter(!Site=="ASHC")
NY_DO_GOLD$``Date Time`` <- as.Date(NY_DO_GOLD$``Date Time``, "%m-%d")
NY_DO_GOLD$Year <- as.faNYor(NY_DO_GOLD$Year)

NY_DO_GOLD_yearly <- NY_DO_GOLD %>% na.omit() %>%
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = faNYor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 2, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO - GOLD") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic()

NY_DO_GOLD_yearly
```

```{r}
pH_CT.GOLD          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('FENC', 'ASHC','GOLD'))
Salinity_CT.GOLD    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC', 'ASHC','GOLD'))
Temperature_CT.GOLD <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC', 'ASHC','GOLD'))
DO_CT.GOLD          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('FENC', 'ASHC','GOLD'))
```
```{r}
Temperature_2023 <- Temperature_CT.GOLD %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-07-01 00:00:00' & ``Date Time`` < '2023-10-15 00:00:00' ) %>% # change date range needed here
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2", "gray")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              stat_cor(label.y = 32)+
              geom_smooth(method = "lm")+
              stat_regline_equation(label.y = 35)+
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")
Temperature_2023

```
```{r}
DO_2024 <- DO_CT.GOLD %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2024-04-20 00:00:00' & ``Date Time`` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2", "gray")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              stat_cor(label.y = 32)+
              geom_smooth(method = "lm")+
              stat_regline_equation(label.y = 35)+
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO - 2024") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic() +
              theme(legend.position = "none")
DO_2024
```



```{r}

## DAILY AVERAGES OF DO - GOLD###

GOLD_DO$``Date Time`` <- as.character(GOLD_DO$``Date Time``)
date_time <- strsplit(GOLD_DO$``Date Time``, " ")  # Split at the space
print(GOLD_DO)

# Create separate columns for date and time
GOLD_DO$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_DO)

GOLD_DO$year<- year(GOLD_DO$date)

GOLD_DO_avg <- GOLD_DO %>% na.omit() %>%
  dplyr::group_by(date , year, Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
GOLD_DO_avg


class(GOLD_DO_avg$Date)
GOLD_DO_avg$date <- as.Date(GOLD_DO_avg$date)

GOLD_DAILY_DO_2023 <- GOLD_DO_avg %>% 
   dplyr::filter(``Date Time`` > '2023-04-01 00:00:00' & ``Date Time`` < '2023-11-30 00:00:00' ) %>%
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")


GOLD_DAILY_DO_2023

pdf(paste0(path="/raw_plots/Report_plots/GOLD_daily_DO_2023.pdf"), height = 7, width = 14)
print(GOLD_DAILY_DO_2023)

GOLD_DAILY_DO_2024 <- GOLD_DO_avg %>% 
   dplyr::filter(`date` > '2024-04-01 00:00:00' & `date` < '2024-11-30' ) %>%
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")+geom_hline(yintercept = 5, color = "red", linetype = "solid", size = 1)+
  geom_hline(yintercept = 3, color = "blue", linetype = "solid", size = 1) 


GOLD_DAILY_DO_2024

pdf(paste0(path="/raw_plots/Report_plots/GOLD_daily_DO_2024.pdf"), height = 7, width = 14)
print(GOLD_DAILY_DO_2024)

# Monthly mean temperatures ASHC
GOLD_Temperature$``Date Time`` <- as.character(GOLD_Temperature$``Date Time``)
date_time <- strsplit(GOLD_Temperature$``Date Time``, " ")  # Split at the space
print(GOLD_Temperature)

# Create separate columns for date and time
GOLD_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_Temperature)

GOLD_Temperature$Month <- month(GOLD_Temperature$date, label = TRUE)
GOLD_Temperature$Year <- year(GOLD_Temperature$date)
head(GOLD_Temperature)


GOLD_Monthly_Temperature <- GOLD_Temperature %>% na.omit() %>%
  dplyr::group_by(Month ,Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
GOLD_Monthly_Temperature

#Salinity average
GOLD_Salinity$``Date Time`` <- as.character(GOLD_Salinity$``Date Time``)
date_time <- strsplit(GOLD_Salinity$``Date Time``, " ")  # Split at the space
print(GOLD_Salinity)

# Create separate columns for date and time
GOLD_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_Salinity)

GOLD_Salinity$Month <- month(GOLD_Salinity$date, label = TRUE)
GOLD_Salinity$Year <- year(GOLD_Salinity$date)
head(GOLD_Salinity)


GOLD_Monthly_Salinity <- GOLD_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
GOLD_Monthly_Salinity

```

#Overlay graph - temperature and pH of the three sites (ASHC, FENC, GOLD) for the whole study
```{r}
#Creating data frames for graph. This method removes the lines during the time with no collections, 2023 season to 2024 season.
TempvspH <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC', 'ASHC', 'GOLD')|variable == 'pH' & Site %in% c('FENC', 'ASHC', 'GOLD'))
TempvspH <- TempvspH %>% dplyr::mutate(Year = year(`Date Time`))

Temp.2023 <- TempvspH %>% filter(Year=="2023") %>% filter(variable=="Temperature")
Temp.rest.ct <- TempvspH %>% filter(Year!="2023") %>% filter(variable=="Temperature") %>% filter(Site!="GOLD")
Temp.GOLD.2024 <- TempvspH %>% filter(Year=="2024")%>% filter (variable=="Temperature")%>% filter(Site == "GOLD")
Temp.GOLD.2025 <- TempvspH %>% filter(Year=="2025")%>% filter (variable=="Temperature")%>% filter(Site == "GOLD")
pH.2023 <- TempvspH %>% filter(Year=="2023") %>% filter(variable=="pH")
pH.rest.ct <- TempvspH %>% filter(Year!="2023") %>% filter(variable=="pH") %>% filter(Site!="GOLD")
pH.GOLD.2024 <- TempvspH %>% filter(Year=="2024") %>% filter(variable=="pH")%>% filter(Site == "GOLD")
pH.GOLD.2025 <- TempvspH %>% filter(Year=="2025") %>% filter(variable=="pH")%>% filter(Site == "GOLD")

#Temperature graph (all sites, all dates)
All_temp.graph <-ggplot()+
              geom_line(data=Temp.2023%>% filter(Site == "FENC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+ #these next lines help determine the order of how the lines will be presented on the graph. FENC on the bottom
  geom_line(data=Temp.2023%>% filter(Site == "ASHC"), aes(x=`Date Time`, #ASHC middle
                       y=mean, color = Site))+
  geom_line(data=Temp.2023%>% filter(Site == "GOLD"), aes(x=`Date Time`, #GOLD on top
                       y=mean, color = Site))+
  geom_line(data=Temp.rest.ct%>% filter(Site == "FENC"), aes(x=`Date Time`, #second half of the graph (2024-2025)
                       y=mean, color = Site))+
  geom_line(data=Temp.rest.ct%>% filter(Site == "ASHC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=Temp.GOLD.2024%>% filter(Site == "GOLD"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=Temp.GOLD.2025%>% filter(Site == "GOLD"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
scale_color_manual(values=c(FENC = "darksalmon",ASHC = "cornflowerblue", GOLD = "darkseagreen")) +
              #ggtitle("Temperature") +
              labs(x = "Date", y = "Temperature (C)") +
            scale_x_datetime(date_labels= "%b %Y", date_breaks = "3 month")+ #x axis labels
  theme(axis.text = element_text(size = 18), axis.title = element_text(size = 22), legend.text = element_text(size=18), 
        legend.title = element_text(size=20), title = element_text(size = 24), strip.text = element_text(size = 18) )+
  geom_hline(yintercept = 20, color = "red", size = .5)+ #highlighting 20C for dermo infection
  geom_hline(yintercept = 16, color = "blue", size = .5) #highlighting 16C for spawning


All_temp.graph

#pH graph (all sites, all dates)
All_pH.graph <-ggplot()+
              geom_line(data=pH.2023%>% filter(Site == "FENC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=pH.2023%>% filter(Site == "ASHC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=pH.2023%>% filter(Site == "GOLD"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=pH.rest.ct%>% filter(Site == "FENC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=pH.rest.ct%>% filter(Site == "ASHC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=pH.GOLD.2024%>% filter(Site == "GOLD"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=pH.GOLD.2025%>% filter(Site == "GOLD"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
scale_color_manual(values=c("FENC" = "darksalmon",ASHC = "cornflowerblue", "GOLD" = "darkseagreen")) +
              ggtitle("pH & Temperature (2023 - 2025)") +
              labs(x = " ", y = "pH") +
              scale_x_datetime(date_labels= "%b %Y", date_breaks = "3 month")+
  theme(axis.text = element_text(size = 18), axis.title = element_text(size = 22), legend.text = element_text(size=18), 
        legend.title = element_text(size=20), title = element_text(size = 24), strip.text = element_text(size = 18) )

All_pH.graph

#combining the two graphs
all_pHvtemp<-ggarrange(All_pH.graph,All_temp.graph, ncol = 1)
all_pHvtemp

pdf(paste0(path = "output/raw_plots/Temperature_pH_all.pdf"), height = 7, width = 14)
print(all_pHvtemp)
dev.off()
```

```{r}
#Overlay for salinity - all sites, all years
Salinity_all <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC', 'ASHC', 'GOLD'))
Salinity_all <- Salinity_all %>% dplyr::mutate(Year = year(`Date Time`))

Salinity.2023 <- Salinity_all %>% filter(Year=="2023")
Salinity.rest.ct <- Salinity_all %>% filter(Year!="2023") %>% filter(Site!="GOLD")
Salinity.GOLD.2024 <- Salinity_all %>% filter(Year=="2024")%>% filter(Site == "GOLD")
Salinity.GOLD.2025 <- Salinity_all %>% filter(Year=="2025")%>% filter(Site == "GOLD")

All_salinity.graph <-ggplot()+
              geom_line(data=Salinity.2023%>% filter(Site == "FENC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=Salinity.2023%>% filter(Site == "ASHC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=Salinity.2023%>% filter(Site == "GOLD"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=Salinity.rest.ct%>% filter(Site == "FENC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=Salinity.rest.ct%>% filter(Site == "ASHC"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=Salinity.GOLD.2024%>% filter(Site == "GOLD"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
  geom_line(data=Salinity.GOLD.2025%>% filter(Site == "GOLD"), aes(x=`Date Time`, 
                       y=mean, color = Site))+
scale_color_manual(values=c("FENC" = "darksalmon",ASHC = "cornflowerblue", "GOLD" = "darkseagreen")) +
              ggtitle("Salinity (2023 - 2025)") +
              labs(x = " ", y = "Salinity") +
              scale_x_datetime(date_labels= "%b %Y", date_breaks = "3 month")+
  theme(axis.text = element_text(size = 18), axis.title = element_text(size = 22), legend.text = element_text(size=18), 
        legend.title = element_text(size=20), title = element_text(size = 24), strip.text = element_text(size = 18) )

All_salinity.graph

pdf(paste0(path = "output/raw_plots/Salinity_all.pdf"), height = 7, width = 14)
print(All_salinity.graph)
dev.off()
```


#NO LONGER STUDYING THIS SITE - LAUR

# Clean LAUR for the LISS stakeholder reports

```{r, figs for LISS stakeholder reports}

LAUR_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('LAUR'))
LAUR_Salinity    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('LAUR'))
LAUR_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('LAUR'))
LAUR_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('LAUR'))
LAUR_CHLA        <- Master_table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll.a.Fluorescence' & Site %in% c('LAUR'))

# pH 
LAUR_pH

LAUR_pH_all <- LAUR_pH %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-06-20 11:00:00' & ``Date Time`` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH ") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


LAUR_pH_all


pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_pH.pdf"), height = 7, width = 14)
print(LAUR_pH_all)
dev.off()
  


# Salinity 
## There are a few outliers in the dataset form removing the sonde to download data. Here is a temporary filter for graphing purposes:
LAUR_Salinity <- LAUR_Salinity[LAUR_Salinity$mean < 35 & LAUR_Salinity$mean > 24, ]

LAUR_Salinity_all <- LAUR_Salinity %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-06-01 00:00:00' & ``Date Time`` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(limits = c(0,30),breaks = seq(0,30, by = 2))

LAUR_Salinity_all

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_Salinity.pdf"), height = 7, width = 14)
print(LAUR_Salinity_all)
dev.off()


# Temperature 

LAUR_Temperature_all <-LAUR_Temperature %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-06-01 00:00:00' & ``Date Time`` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
LAUR_Temperature_all


pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_Temperature.pdf"), height = 7, width = 14)
print(LAUR_Temperature_all)
dev.off()


# DO 

LAUR_DO_all <- LAUR_DO %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-06-01 00:00:00' & ``Date Time`` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_DO.pdf"), height = 7, width = 14)
print(LAUR_DO_all)
dev.off()

#Chlorophyll-a

LAUR_CHLA_all <- LAUR_CHLA %>% na.omit() %>%
             dplyr::filter(``Date Time`` > '2023-06-01 00:00:00' & ``Date Time`` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=``Date Time``, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

LAUR_CHLA_all

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_CHLA.pdf"), height = 7, width = 14)
print(LAUR_CHLA_all)

```

```{r}

## DAILY AVERAGES OF DO - LAUR ###

LAUR_DO$``Date Time`` <- as.character(LAUR_DO$``Date Time``)
date_time <- strsplit(LAUR_DO$``Date Time``, " ")  # Split at the space
print(LAUR_DO)

# Create separate columns for date and time
LAUR_DO$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_DO)


LAUR_DO_avg <- LAUR_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
LAUR_DO_avg


class(LAUR_DO_avg$Date)
LAUR_DO_avg$date <- as.Date(LAUR_DO_avg$date)

LAUR_DAILY_DO <- LAUR_DO_avg %>% ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")  +  scale_y_continuous(limits = c(0,10), breaks = seq(0,10, by = 1))


LAUR_DAILY_DO

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_daily_DO.pdf"), height = 7, width = 14)
print(LAUR_DAILY_DO)

# Monthly mean temperatures ASHC
LAUR_Temperature$``Date Time`` <- as.character(LAUR_Temperature$``Date Time``)
date_time <- strsplit(LAUR_Temperature$``Date Time``, " ")  # Split at the space
print(LAUR_Temperature)

# Create separate columns for date and time
LAUR_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_Temperature)

LAUR_Temperature$Month <- month(LAUR_Temperature$date, label = TRUE)
head(LAUR_Temperature)

LAUR_Monthly_Temperature <- LAUR_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
LAUR_Monthly_Temperature

#Salinity average
LAUR_Salinity$``Date Time`` <- as.character(LAUR_Salinity$``Date Time``)
date_time <- strsplit(LAUR_Salinity$``Date Time``, " ")  # Split at the space
print(LAUR_Salinity)

# Create separate columns for date and time
LAUR_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_Salinity)

LAUR_Salinity$Month <- month(LAUR_Salinity$date, label = TRUE)
head(LAUR_Salinity)

LAUR_Monthly_Salinity <- LAUR_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
LAUR_Monthly_Salinity

```

