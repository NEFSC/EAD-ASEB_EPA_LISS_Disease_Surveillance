BCS_proportion_all_2023<- ggplot(data=df_BCS_proportions2023, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill", colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = .4, hjust=.5))+
labs(title="Proportion of body condition scores - 2023", x ="month", y = "Proportion of body condition scores ")+ theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+
scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+
facet_wrap(~ site)
BCS_proportion_all_2023
#pdf(paste0(path = "Lab_Data_TissueProcessing/output" ,"/all_BCS_proportion_2023.pdf"), height = 7, width = 13)
#print(BCS_proportion_all_2023)
#dev.off()
#Proportions graph Body condition scores - 2023
df_BCS_proportions2023<- data_2023 %>%
mutate(condition_score_numeric = as.numeric(condition_score),condition_score_bin = case_when(condition_score == 1 ~ "1", condition_score == 2 ~"2",condition_score == 3 ~ "3", condition_score == 4 ~"4",condition_score == 5 ~ "5", condition_score == 6 ~"6",condition_score == 7 ~ "7", condition_score == 8 ~"8", condition_score ==9 ~"9", TRUE ~ as.character(condition_score))) %>%
group_by(site, month, year, condition_score_bin) %>% dplyr ::summarise(Count= n()) %>%
ungroup() %>%
mutate(Proportion = Count/sum(Count))
df_BCS_proportions2023<- na.omit(df_BCS_proportions2023)
BCS_proportion_all_2023<- ggplot(data=df_BCS_proportions2023, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill", colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = .4, hjust=.5))+
labs(title="Proportion of body condition scores - 2023", x ="month", y = "Proportion of body condition scores ")+ theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)#+scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+
facet_wrap(~ site)
BCS_proportion_all_2023
#pdf(paste0(path = "Lab_Data_TissueProcessing/output" ,"/all_BCS_proportion_2023.pdf"), height = 7, width = 13)
#print(BCS_proportion_all_2023)
#dev.off()
#Proportions graph Body condition scores - 2023
df_BCS_proportions2023<- data_2023 %>%
mutate(condition_score_numeric = as.numeric(condition_score),condition_score_bin = case_when(condition_score == 1 ~ "1", condition_score == 2 ~"2",condition_score == 3 ~ "3", condition_score == 4 ~"4",condition_score == 5 ~ "5", condition_score == 6 ~"6",condition_score == 7 ~ "7", condition_score == 8 ~"8", condition_score ==9 ~"9", TRUE ~ as.character(condition_score))) %>%
group_by(site, month, year, condition_score_bin) %>% dplyr ::summarise(Count= n()) %>%
ungroup() %>%
mutate(Proportion = Count/sum(Count))
df_BCS_proportions2023<- na.omit(df_BCS_proportions2023)
BCS_proportion_all_2023<- ggplot(data=df_BCS_proportions2023, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill", colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = .4, hjust=.5))+
labs(title="Proportion of body condition scores - 2023", x ="month", y = "Proportion of body condition scores ")+ theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+#+scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+
facet_wrap(~ site)
BCS_proportion_all_2023
#pdf(paste0(path = "Lab_Data_TissueProcessing/output" ,"/all_BCS_proportion_2023.pdf"), height = 7, width = 13)
#print(BCS_proportion_all_2023)
#dev.off()
#Proportions graph Body condition scores - 2023
df_BCS_proportions2023<- data_2023 %>%
mutate(condition_score_numeric = as.numeric(condition_score),condition_score_bin = case_when(condition_score == 1 ~ "1", condition_score == 2 ~"2",condition_score == 3 ~ "3", condition_score == 4 ~"4",condition_score == 5 ~ "5", condition_score == 6 ~"6",condition_score == 7 ~ "7", condition_score == 8 ~"8", condition_score ==9 ~"9", TRUE ~ as.character(condition_score))) %>%
group_by(site, month, year, condition_score_bin) %>% dplyr ::summarise(Count= n()) %>%
ungroup() %>%
mutate(Proportion = Count/sum(Count))
df_BCS_proportions2023<- na.omit(df_BCS_proportions2023)
BCS_proportion_all_2023<- ggplot(data=df_BCS_proportions2023, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill", colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = .4, hjust=.5))+
labs(title="Proportion of body condition scores - 2023", x ="month", y = "Proportion of body condition scores ")+ theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+
facet_wrap(~ site)
BCS_proportion_all_2023
#pdf(paste0(path = "Lab_Data_TissueProcessing/output" ,"/all_BCS_proportion_2023.pdf"), height = 7, width = 13)
#print(BCS_proportion_all_2023)
#dev.off()
#Proportions graph Body condition scores - 2023
df_BCS_proportions2023<- data_2023 %>%
mutate(condition_score_numeric = as.numeric(condition_score),condition_score_bin = case_when(condition_score == 1 ~ "1", condition_score == 2 ~"2",condition_score == 3 ~ "3", condition_score == 4 ~"4",condition_score == 5 ~ "5", condition_score == 6 ~"6",condition_score == 7 ~ "7", condition_score == 8 ~"8", condition_score ==9 ~"9", TRUE ~ as.character(condition_score))) %>%
group_by(site, month, year, condition_score_bin) %>% dplyr ::summarise(Count= n()) %>%
ungroup() %>%
mutate(Proportion = Count/sum(Count))
df_BCS_proportions2023<- na.omit(df_BCS_proportions2023)
BCS_proportion_all_2023<- ggplot(data=df_BCS_proportions2023, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill", colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = .4, hjust=.5))+
labs(title="Proportion of body condition scores - 2023", x ="month", y = "Proportion of body condition scores ")+ theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+#+scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+
facet_wrap(~ site)
BCS_proportion_all_2023
#pdf(paste0(path = "Lab_Data_TissueProcessing/output" ,"/all_BCS_proportion_2023.pdf"), height = 7, width = 13)
#print(BCS_proportion_all_2023)
#dev.off()
#Proportions graph Body condition scores - 2023
df_BCS_proportions2023<- data_2023 %>%
mutate(condition_score_numeric = as.numeric(condition_score),condition_score_bin = case_when(condition_score == 1 ~ "1", condition_score == 2 ~"2",condition_score == 3 ~ "3", condition_score == 4 ~"4",condition_score == 5 ~ "5", condition_score == 6 ~"6",condition_score == 7 ~ "7", condition_score == 8 ~"8", condition_score ==9 ~"9", TRUE ~ as.character(condition_score))) %>%
group_by(site, month, year, condition_score_bin) %>% dplyr ::summarise(Count= n()) %>%
ungroup() %>%
mutate(Proportion = Count/sum(Count))
df_BCS_proportions2023<- na.omit(df_BCS_proportions2023)
BCS_proportion_all_2023<- ggplot(data=df_BCS_proportions2023, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill", colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = .4, hjust=.5))+
labs(title="Proportion of body condition scores - 2023", x ="month", y = "Proportion of body condition scores ")+ theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+
facet_wrap(~ site)
BCS_proportion_all_2023
#pdf(paste0(path = "Lab_Data_TissueProcessing/output" ,"/all_BCS_proportion_2023.pdf"), height = 7, width = 13)
#print(BCS_proportion_all_2023)
#dev.off()
# Proportion per month of intensity scores at three sites during 2023 & 2024 & 2025 & 2026
df_bcs_proportions_new <- rbind(df_BCS_proportions2023, df_BCS_proportions2024, df_BCS_proportions2025, df_BCS_proportions2026)
df_bcs_proportions_new<- df_bcs_proportions_new %>% filter(!site=="LAUR")
Proportion_of_Body_Condition_Scores <- ggplot(data=df_bcs_proportions_new, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill",colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=.5))+
labs(fill ="Body condition scores", element_text(size = 1.5))+
labs(title="Proportion of body condition scores", x ="month", y = "Proportion")+ theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(title = element_text(size = 20))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+ #scale_fill_brewer(palette = "Spectral", direction = -1) -- is also a good palette option
scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+ scale_size(element_text(size = rel(1.0)))+
facet_grid(year ~site)+
theme(strip.text = element_text(size = 15))+theme(legend.position = "right")
print(Proportion_of_Body_Condition_Scores)
# Proportion per month of intensity scores at three sites during 2023 & 2024 & 2025 & 2026
df_bcs_proportions_new <- rbind(df_BCS_proportions2023, df_BCS_proportions2024, df_BCS_proportions2025, df_BCS_proportions2026)
df_bcs_proportions_new<- df_bcs_proportions_new %>% filter(!site=="LAUR")
Proportion_of_Body_Condition_Scores <- ggplot(data=df_bcs_proportions_new, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill",colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = 1, hjust=.5))+
labs(fill ="Body condition scores", element_text(size = 1.5))+
labs(title="Proportion of body condition scores", x ="month", y = "Proportion")+ theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(title = element_text(size = 20))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+ #scale_fill_brewer(palette = "Spectral", direction = -1) -- is also a good palette option
scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+ scale_size(element_text(size = rel(1.0)))+
facet_grid(year ~site)+
theme(strip.text = element_text(size = 15))+theme(legend.position = "right")
print(Proportion_of_Body_Condition_Scores)
# Proportion per month of intensity scores at three sites during 2023 & 2024 & 2025 & 2026
df_bcs_proportions_new <- rbind(df_BCS_proportions2023, df_BCS_proportions2024, df_BCS_proportions2025, df_BCS_proportions2026)
df_bcs_proportions_new<- df_bcs_proportions_new %>% filter(!site=="LAUR")
Proportion_of_Body_Condition_Scores <- ggplot(data=df_bcs_proportions_new, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill",colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = 1, hjust=.5))+
labs(fill ="Body condition scores", element_text(size = 1.5))+
labs(title="Proportion of body condition scores", x ="month", y = "Proportion")+ theme(axis.title.y = element_text(size = rel(1.0), angle =90), axis.title.x = element_text(size = rel(1.0), angle = 0))+
theme(title = element_text(size = 20))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+ #scale_fill_brewer(palette = "Spectral", direction = -1) -- is also a good palette option
scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+ scale_size(element_text(size = rel(1.0)))+
facet_grid(year ~site)+
theme(strip.text = element_text(size = 15))+theme(legend.position = "right")
print(Proportion_of_Body_Condition_Scores)
# Proportion per month of intensity scores at three sites during 2023 & 2024 & 2025 & 2026
df_bcs_proportions_new <- rbind(df_BCS_proportions2023, df_BCS_proportions2024, df_BCS_proportions2025, df_BCS_proportions2026)
df_bcs_proportions_new<- df_bcs_proportions_new %>% filter(!site=="LAUR")
Proportion_of_Body_Condition_Scores <- ggplot(data=df_bcs_proportions_new, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill",colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = 1, hjust=.5))+
labs(fill ="Body Condition Scores", element_text(size = 1.5))+
labs(title="Proportion of Body Condition Scores", x ="month", y = "Proportion")+ theme(axis.title.y = element_text(size = rel(1.0), angle =90), axis.title.x = element_text(size = rel(1.0), angle = 0))+
theme(title = element_text(size = 20))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+ #scale_fill_brewer(palette = "Spectral", direction = -1) -- is also a good palette option
scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+ scale_size(element_text(size = rel(1.0)))+
facet_grid(year ~site)+
theme(strip.text = element_text(size = 15))+theme(legend.position = "right")
print(Proportion_of_Body_Condition_Scores)
# Proportion per month of intensity scores at three sites during 2023 & 2024 & 2025 & 2026
df_bcs_proportions_new <- rbind(df_BCS_proportions2023, df_BCS_proportions2024, df_BCS_proportions2025, df_BCS_proportions2026)
df_bcs_proportions_new<- df_bcs_proportions_new %>% filter(!site=="LAUR")
Proportion_of_Body_Condition_Scores <- ggplot(data=df_bcs_proportions_new, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill",colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = 1, hjust=.5))+
labs(fill ="Body Condition Scores", element_text(size = 1.5))+
labs(title="Proportion of Body Condition Scores", x ="month", y = "Proportion")+ theme(axis.title.y = element_text(size = rel(1.0), angle =90), axis.title.x = element_text(size = rel(1.0), angle = 0))+
theme(title = element_text(size = 20))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+ scale_fill_brewer(palette = "Spectral", direction = -1)+ -- is also a good palette option
# Proportion per month of intensity scores at three sites during 2023 & 2024 & 2025 & 2026
df_bcs_proportions_new <- rbind(df_BCS_proportions2023, df_BCS_proportions2024, df_BCS_proportions2025, df_BCS_proportions2026)
df_bcs_proportions_new<- df_bcs_proportions_new %>% filter(!site=="LAUR")
Proportion_of_Body_Condition_Scores <- ggplot(data=df_bcs_proportions_new, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill",colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = 1, hjust=.5))+
labs(fill ="Body Condition Scores", element_text(size = 1.5))+
labs(title="Proportion of Body Condition Scores", x ="month", y = "Proportion")+ theme(axis.title.y = element_text(size = rel(1.0), angle =90), axis.title.x = element_text(size = rel(1.0), angle = 0))+
theme(title = element_text(size = 20))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Spectral", direction = -1)+ #can use palette "Spectral"
scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+ scale_size(element_text(size = rel(1.0)))+
facet_grid(year ~site)+
theme(strip.text = element_text(size = 15))+theme(legend.position = "right")
print(Proportion_of_Body_Condition_Scores)
# Proportion per month of intensity scores at three sites during 2023 & 2024 & 2025 & 2026
df_bcs_proportions_new <- rbind(df_BCS_proportions2023, df_BCS_proportions2024, df_BCS_proportions2025, df_BCS_proportions2026)
df_bcs_proportions_new<- df_bcs_proportions_new %>% filter(!site=="LAUR")
Proportion_of_Body_Condition_Scores <- ggplot(data=df_bcs_proportions_new, aes(x=month, y= Proportion, fill=condition_score_bin)) +
geom_bar(width = .5, stat="identity", position = "fill",colour = "black")+
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 0, vjust = 1, hjust=.5))+
labs(fill ="Body Condition Scores", element_text(size = 1.5))+
labs(title="Proportion of Body Condition Scores", x ="month", y = "Proportion")+ theme(axis.title.y = element_text(size = rel(1.0), angle =90), axis.title.x = element_text(size = rel(1.0), angle = 0))+
theme(title = element_text(size = 20))+
theme(axis.text=element_text(size=12))+
scale_fill_brewer(palette = "Blues", direction = -1)+ #can use palette "Spectral"
scale_x_continuous("Month", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12))+ scale_size(element_text(size = rel(1.0)))+
facet_grid(year ~site)+
theme(strip.text = element_text(size = 15))+theme(legend.position = "right")
print(Proportion_of_Body_Condition_Scores)
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
cache = TRUE)
knitr::opts_knit$set(root.dir =
"C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
library(ggplot2)
library(dplyr)
library(gplots)
library(RColorBrewer)
library(ggpubr)
library(stringr)
library(lubridate)
library(readr)
library(reshape2)
library(tidyverse) # read_csv call from readr, included in tidyverse
Master_table <- read.csv("output/Sonde_master.csv",check.names=FALSE) %>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.' )
Master_table$Date.Time <- lubridate::ymd_hms(Master_table$Date.Time)
View(Master_table)
# melt is akin to pivot_longer, but I like that its called melt so I prefer it
# Im melting Im melting
library(reshape2)
library(data.table)
Master_table_LONG <- Master_table %>%
reshape2::melt(id.vars = c("Date.Time", "Site"),
measure.vars = c("Salinity","RDO.Concentration","Chlorophyll.a.Fluorescence","pH","pH.mV","Temperature"))
Master_table_LONG_means <- Master_table %>%
dplyr::mutate(Date.Time = as.factor(substr(Date.Time,1,13))) %>% # remove minutes and seconds
reshape2::melt(id.vars = c("Date.Time", "Site"),
measure.vars = c("Salinity","RDO.Concentration", "Chlorophyll.a.Fluorescence", "pH", "pH.mV","Temperature")) %>%
dplyr::group_by(Date.Time, Site, variable) %>%
summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), value) %>%
dplyr::mutate(Date.Time = ymd_h(Date.Time)) # reformat back to date
vars <- as.data.frame(
list(
as.character(
unique(
Master_table_LONG_means$variable)))) %>%
dplyr::rename(dat = 1)
#write.csv(Master_table_LONG_means, "output/Sonde_hourly_means_master.csv",)
monthly_mean_ph <- Master_monthly_means[Master_monthly_means$variable =="pH", ]
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
cache = TRUE)
knitr::opts_knit$set(root.dir =
"C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
library(ggplot2)
library(dplyr)
library(gplots)
library(RColorBrewer)
library(ggpubr)
library(stringr)
library(lubridate)
library(readr)
library(reshape2)
library(tidyverse) # read_csv call from readr, included in tidyverse
Aragonite_master <- read.csv("C:/Users/sarina.dery/Documents/CO2sys_Water_Quality_Data.csv", check.names=FALSE) #%>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.')
Aragonite_master <- rename(Aragonite_master, c("date_collected"="Date collected","Aragonite_Sat"="WAr out","Site"="Location", "Total CO2 (ppm)"="xCO2 out (dry at 1 atm) (ppm)", "Temp(C)_Field"="temp(C) of field"))
Aragonite_master <- Aragonite_master%>% dplyr::mutate(date_collected= as.Date(date_collected), month = month(date_collected))
#load data for aragnoite saturation
Aragonite_master <- read.csv("C:/Users/sarina.dery/Documents/CO2sys_Water_Quality_Data.csv", check.names=FALSE) #%>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.')
Aragonite_master <- rename(Aragonite_master, c("date_collected"="Date collected","Aragonite_Sat"="WAr out","Site"="Location", "Total CO2 (ppm)"="xCO2 out (dry at 1 atm) (ppm)", "Temp(C)_Field"="temp(C) of field"))
Aragonite_master <- Aragonite_master%>% dplyr::mutate(date_collected= as.Date(date_collected), month = month(date_collected))
View(Aragonite_master)
Aragonite_master <- rename(Aragonite_master, c("date_collected"="Date collected","Aragonite_Sat"="WAr out","Site"="Location", "Total CO2 (ppm)"="xCO2 out (dry at 1 atm) (ppm)", "Temp(C)_Field"="temp(C) of field"))
View(Aragonite_master)
Aragonite_master <- rename(Aragonite_master, c("Date collected"="date_collected"))
Aragonite_master <- rename(Aragonite_master, c("Date collected"="date_collected","Site"="Location"))
Aragonite_master <- rename(Aragonite_master, c("Date collected"="date_collected","Location"="Site"))
Aragonite_master <- rename(Aragonite_master, c("Date collected"="date_collected","Location"="Site", "WAr out"="Aragonite_Sat", "xCO2 out (dry at 1 atm) (ppm)" = "Total CO2 (ppm)", "temp(C) of field"="Temp(C)_Field"))
View(data_2025)
#load data for aragnoite saturation
Aragonite_master <- read.csv("C:/Users/sarina.dery/Documents/CO2sys_Water_Quality_Data.csv", check.names=FALSE) #%>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.')
Aragonite_master <- rename(Aragonite_master, c("Date collected"="date_collected","Location"="Site", "WAr out"="Aragonite_Sat", "xCO2 out (dry at 1 atm) (ppm)" = "Total CO2 (ppm)", "temp(C) of field"="Temp(C)_Field"))
Aragonite_master <- Aragonite_master%>% dplyr::mutate(date_collected= as.Date(date_collected), month = month(date_collected))
Aragonite_master <- Aragonite_master %>% dplyr::mutate(date_collected= as.Date(date_collected), year = year(date_collected))
#changing numeric month to month name
Aragonite_master$month <- factor(Aragonite_master$month, levels = c("1","2","3","4","5","6","7", "8", "9", "10", "11", "12"),
labels=c("Jan","Feb", "March","April","May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec"))
head(Aragonite_master)
Aragonite_master_long<- Aragonite_master %>%
reshape2::melt(id.vars = c("date_collected", "Site","month","year"),
measure.vars = c("Salinity","Temp(C)_Field","pH","pCO2 out (matm)","HCO3 out (mmol/kgSW)","CO3 out (mmol/kgSW)","CO2 out (mmol/kgSW)","Aragonite_Sat","Total CO2 (ppm)"))
head(Aragonite_master_long)
Aragonite_master <- read.csv("C:/Users/sarina.dery/Documents/CO2sys_Water_Quality_Data.csv", check.names=FALSE) #%>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.')
Aragonite_master <- rename(Aragonite_master, c("Date collected"="date_collected","Location"="Site", "WAr out"="Aragonite_Sat", "xCO2 out (dry at 1 atm) (ppm)" = "Total CO2 (ppm)", "temp(C) of field"="Temp(C)_Field"))
Aragonite_master <- Aragonite_master%>% dplyr::mutate(date_collected= as.Date(date_collected), month = month(date_collected))
Aragonite_master <- Aragonite_master %>% dplyr::mutate(date_collected= as.Date(date_collected), year = year(date_collected))
#changing numeric month to month name
Aragonite_master$month <- factor(Aragonite_master$month, levels = c("1","2","3","4","5","6","7", "8", "9", "10", "11", "12"),
labels=c("Jan","Feb", "March","April","May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec"))
head(Aragonite_master)
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
cache = TRUE)
knitr::opts_knit$set(root.dir =
"C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation)
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
cache = TRUE)
knitr::opts_knit$set(root.dir =
"C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation")
library(ggplot2)
library(dplyr)
library(gplots)
library(RColorBrewer)
library(ggpubr)
library(stringr)
library(lubridate)
library(readr)
library(reshape2)
library(tidyverse) # read_csv call from readr, included in tidyverse
Aragonite_master <- read.csv("C:/Users/sarina.dery/Documents/CO2sys_Water_Quality_Data.csv", check.names=FALSE) #%>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.')
Aragonite_master <- rename(Aragonite_master, c("Date collected"="date_collected","Location"="Site", "WAr out"="Aragonite_Sat", "xCO2 out (dry at 1 atm) (ppm)" = "Total CO2 (ppm)", "temp(C) of field"="Temp(C)_Field"))
Aragonite_master <- Aragonite_master%>% dplyr::mutate(date_collected= as.Date(date_collected), month = month(date_collected))
Aragonite_master <- Aragonite_master %>% dplyr::mutate(date_collected= as.Date(date_collected), year = year(date_collected))
#changing numeric month to month name
Aragonite_master$month <- factor(Aragonite_master$month, levels = c("1","2","3","4","5","6","7", "8", "9", "10", "11", "12"),
labels=c("Jan","Feb", "March","April","May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec"))
head(Aragonite_master)
Aragonite_master_long<- Aragonite_master %>%
reshape2::melt(id.vars = c("date_collected", "Site","month","year"),
measure.vars = c("Salinity","Temp(C)_Field","pH","pCO2 out (matm)","HCO3 out (mmol/kgSW)","CO3 out (mmol/kgSW)","CO2 out (mmol/kgSW)","Aragonite_Sat","Total CO2 (ppm)"))
head(Aragonite_master_long)
#boxplot for aragonite saturation per site 2023-2025
Mean_aragonite_sat_all <- ggplot(data=Aragonite_master_long %>%
filter(variable == "Aragonite_Sat"), aes(x=Site, y=value, fill=Site)) +geom_boxplot()+ #scale_fill_manual(values=c("forestgreen","orange", "purple"))
theme_bw() + theme(plot.title = element_text(size = 20))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12))+
theme(axis.text.y = element_text(size = 12),
axis.title.y = element_text(size =15))+
labs(title="Mean Aragonite Saturation 2023 - 2025 ", x ="", y = "Aragonite Sauration (Ωar)")+
scale_y_continuous(limits = c(0,2))+ facet_wrap(.~year)+
theme(strip.text = element_text(size = 12))+theme(legend.position = "none")+
geom_hline(yintercept = 1, color = "red", size = .5)
#pdf(paste0(path ="C:/Users/sarina.dery/Documents/LISP - Oyster Health/Mean_aragonite_sat_all.pdf"), height = 8, width = 10)
print(Mean_aragonite_sat_all)
#dev.off()
Aragonite_Sat <- Aragonite_master_long %>% filter(variable=="Aragonite_Sat")
Aragonite_vs_time <- ggplot(data=Aragonite_Sat,aes(x=date_collected, y=value, color=Site))+
geom_line(data=Aragonite_Sat %>% filter(Site == "FENC"), aes(x=date_collected, y=value, color="Site"))
print(Aragonite_vs_time)
#+
geom_line(data=Aragonite_Sat %>% filter(Site == "ASHC"),aes(x="date_collected", y=value, color=Site))+
geom_line(data=Aragonite_Sat %>% filter(Site == "GOLD"), aes(x="date_collected",
y=value, color=Site))+
scale_color_manual(values=c(ASHC = "darksalmon",GOLD = "cornflowerblue", FENC = "darkseagreen"))+
ggtitle("Aragonite Saturation 2023 - 2025")+
#scale_x_datetime(date_labels= "%b%Y", date_breaks = "1 month")+
labs(x = "Month", y = "Aragonite Sauration (Ωar)")+
theme(ggtitle(element_text(size=rel(1.5))))+
theme(axis.text = element_text(size = 10), axis.title = element_text(size = 12), legend.text = element_text(size=10),
legend.title = element_text(size=12), title = element_text(size = 15), strip.text = element_text(size = 10) )+ #facet_grid()+
geom_hline(yintercept = 3, color = "red", size = .5)+geom_hline(yintercept = 1, color = "red", size = .5)
Aragonite_vs_time <- ggplot(data=Aragonite_Sat,aes(x=date_collected, y=value, color=Site))+
geom_line(data=Aragonite_Sat %>% filter(Site == "FENC"), aes(x=date_collected, y=value, color="Site"))
print(Aragonite_vs_time)
#+
geom_line(data=Aragonite_Sat %>% filter(Site == "ASHC"),aes(x="date_collected", y=value, color=Site))+
geom_line(data=Aragonite_Sat %>% filter(Site == "GOLD"), aes(x="date_collected",
y=value, color=Site))+
scale_color_manual(values=c(ASHC = "darksalmon",GOLD = "cornflowerblue", FENC = "darkseagreen"))+
ggtitle("Aragonite Saturation 2023 - 2025")+
#scale_x_datetime(date_labels= "%b%Y", date_breaks = "1 month")+
labs(x = "Month", y = "Aragonite Sauration (Ωar)")+
theme(ggtitle(element_text(size=rel(1.5))))+
theme(axis.text = element_text(size = 10), axis.title = element_text(size = 12), legend.text = element_text(size=10),
legend.title = element_text(size=12), title = element_text(size = 15), strip.text = element_text(size = 10) )+ #facet_grid()+
geom_hline(yintercept = 3, color = "red", size = .5)+geom_hline(yintercept = 1, color = "red", size = .5)
avg_monthly_pH <- read.csv("Sonde_monthly_ph_long.csv")
avg_monthly_pH <- read.csv("Sonde_monthly_ph_long.csv")
knitr::opts_knit$set(root.dir =
"C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
avg_monthly_pH <- read.csv("Sonde_monthly_ph_long.csv")
avg_monthly_pH <- read.csv("Sonde_monthly_ph_long.csv")
Aragonite_vs_time <- ggplot(data=Aragonite_Sat,aes(x=date_collected, y=value, color=Site))+
geom_line(data=Aragonite_Sat %>% filter(Site == "FENC"), aes(x=date_collected, y=value, color="Site"))
print(Aragonite_vs_time)
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
cache = TRUE)
knitr::opts_knit$set(root.dir =
"C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation")
#boxplot for aragonite saturation per site 2023-2025
Mean_aragonite_sat_all <- ggplot(data=Aragonite_master_long %>%
filter(variable == "Aragonite_Sat"), aes(x=Site, y=value, fill=Site)) +geom_boxplot()+ #scale_fill_manual(values=c("forestgreen","orange", "purple"))
theme_bw() + theme(plot.title = element_text(size = 20))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12))+
theme(axis.text.y = element_text(size = 12),
axis.title.y = element_text(size =15))+
labs(title="Mean Aragonite Saturation 2023 - 2025 ", x ="", y = "Aragonite Sauration (Ωar)")+
scale_y_continuous(limits = c(0,2))+ facet_wrap(.~year)+
theme(strip.text = element_text(size = 12))+theme(legend.position = "none")+
geom_hline(yintercept = 1, color = "red", size = .5)
#pdf(paste0(path ="C:/Users/sarina.dery/Documents/LISP - Oyster Health/Mean_aragonite_sat_all.pdf"), height = 8, width = 10)
print(Mean_aragonite_sat_all)
#dev.off()
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
cache = TRUE)
knitr::opts_knit$set(root.dir =
"C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation/code")
#boxplot for aragonite saturation per site 2023-2025
Mean_aragonite_sat_all <- ggplot(data=Aragonite_master_long %>%
filter(variable == "Aragonite_Sat"), aes(x=Site, y=value, fill=Site)) +geom_boxplot()+ #scale_fill_manual(values=c("forestgreen","orange", "purple"))
theme_bw() + theme(plot.title = element_text(size = 20))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12))+
theme(axis.text.y = element_text(size = 12),
axis.title.y = element_text(size =15))+
labs(title="Mean Aragonite Saturation 2023 - 2025 ", x ="", y = "Aragonite Sauration (Ωar)")+
scale_y_continuous(limits = c(0,2))+ facet_wrap(.~year)+
theme(strip.text = element_text(size = 12))+theme(legend.position = "none")+
geom_hline(yintercept = 1, color = "red", size = .5)
pdf(paste0(path = "Side_projects/Aragonite_Saturation/outputs/", "Mean_aragonite_sat_all.pdf"), height = 8, width = 10)
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
cache = TRUE)
knitr::opts_knit$set(root.dir =
"C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation")
library(ggplot2)
library(dplyr)
library(gplots)
library(RColorBrewer)
library(ggpubr)
library(stringr)
library(lubridate)
library(readr)
library(reshape2)
library(tidyverse) # read_csv call from readr, included in tidyverse
Aragonite_master <- read.csv("C:/Users/sarina.dery/Documents/CO2sys_Water_Quality_Data.csv", check.names=FALSE) #%>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.')
Aragonite_master <- rename(Aragonite_master, c("Date collected"="date_collected","Location"="Site", "WAr out"="Aragonite_Sat", "xCO2 out (dry at 1 atm) (ppm)" = "Total CO2 (ppm)", "temp(C) of field"="Temp(C)_Field"))
Aragonite_master <- Aragonite_master%>% dplyr::mutate(date_collected= as.Date(date_collected), month = month(date_collected))
Aragonite_master <- Aragonite_master %>% dplyr::mutate(date_collected= as.Date(date_collected), year = year(date_collected))
#changing numeric month to month name
Aragonite_master$month <- factor(Aragonite_master$month, levels = c("1","2","3","4","5","6","7", "8", "9", "10", "11", "12"),
labels=c("Jan","Feb", "March","April","May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec"))
head(Aragonite_master)
Aragonite_master_long<- Aragonite_master %>%
reshape2::melt(id.vars = c("date_collected", "Site","month","year"),
measure.vars = c("Salinity","Temp(C)_Field","pH","pCO2 out (matm)","HCO3 out (mmol/kgSW)","CO3 out (mmol/kgSW)","CO2 out (mmol/kgSW)","Aragonite_Sat","Total CO2 (ppm)"))
head(Aragonite_master_long)
#boxplot for aragonite saturation per site 2023-2025
Mean_aragonite_sat_all <- ggplot(data=Aragonite_master_long %>%
filter(variable == "Aragonite_Sat"), aes(x=Site, y=value, fill=Site)) +geom_boxplot()+ #scale_fill_manual(values=c("forestgreen","orange", "purple"))
theme_bw() + theme(plot.title = element_text(size = 20))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12))+
theme(axis.text.y = element_text(size = 12),
axis.title.y = element_text(size =15))+
labs(title="Mean Aragonite Saturation 2023 - 2025 ", x ="", y = "Aragonite Sauration (Ωar)")+
scale_y_continuous(limits = c(0,2))+ facet_wrap(.~year)+
theme(strip.text = element_text(size = 12))+theme(legend.position = "none")+
geom_hline(yintercept = 1, color = "red", size = .5) #red line is at equilibrium
pdf(paste0(path = "Side_projects/Aragonite_Saturation/outputs/", "Mean_aragonite_sat_all.pdf"), height = 8, width = 10)
#boxplot for aragonite saturation per site 2023-2025
Mean_aragonite_sat_all <- ggplot(data=Aragonite_master_long %>%
filter(variable == "Aragonite_Sat"), aes(x=Site, y=value, fill=Site)) +geom_boxplot()+ #scale_fill_manual(values=c("forestgreen","orange", "purple"))
theme_bw() + theme(plot.title = element_text(size = 20))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12))+
theme(axis.text.y = element_text(size = 12),
axis.title.y = element_text(size =15))+
labs(title="Mean Aragonite Saturation 2023 - 2025 ", x ="", y = "Aragonite Sauration (Ωar)")+
scale_y_continuous(limits = c(0,2))+ facet_wrap(.~year)+
theme(strip.text = element_text(size = 12))+theme(legend.position = "none")+
geom_hline(yintercept = 1, color = "red", size = .5) #red line is at equilibrium
pdf(paste0(path = "Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation/outputs/", "Mean_aragonite_sat_all.pdf"), height = 8, width = 10)
#boxplot for aragonite saturation per site 2023-2025
Mean_aragonite_sat_all <- ggplot(data=Aragonite_master_long %>%
filter(variable == "Aragonite_Sat"), aes(x=Site, y=value, fill=Site)) +geom_boxplot()+ #scale_fill_manual(values=c("forestgreen","orange", "purple"))
theme_bw() + theme(plot.title = element_text(size = 20))+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12))+
theme(axis.text.y = element_text(size = 12),
axis.title.y = element_text(size =15))+
labs(title="Mean Aragonite Saturation 2023 - 2025 ", x ="", y = "Aragonite Sauration (Ωar)")+
scale_y_continuous(limits = c(0,2))+ facet_wrap(.~year)+
theme(strip.text = element_text(size = 12))+theme(legend.position = "none")+
geom_hline(yintercept = 1, color = "red", size = .5) #red line is at equilibrium
#pdf(paste0(path = "Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation/outputs/", "Mean_aragonite_sat_all.pdf"), height = 8, width = 10)
print(Mean_aragonite_sat_all)
#dev.off()
pdf(paste0(path = "C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation/outputs/"Mean_aragonite_sat_all.pdf"), height = 8, width = 10)
dev.off()
pdf(paste0(path = "C:/Users/sarina.dery/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Side_projects/Aragonite_Saturation/outputs/Mean_aragonite_sat_all.pdf"), height = 8, width = 10)
print(Mean_aragonite_sat_all)
dev.off()
